<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<title>ä¸‰æ¨“é–±è¦½å¸­ â€” é¸ä½ + å•ç­”</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{
    --bg:#f4f7fb;
    --card:#fff;
    --seat:#d9eaff;
    --seat-border:#6b99c3;
    --laptop:#c4f3d8;
    --laptop-border:#4da56b;
    --occupied:#333;
    --text:#212121;
    --accent:#1976d2;
  }
  body{
    margin:0; padding:18px; font-family:"Microsoft JhengHei",sans-serif;
    background:var(--bg); color:var(--text);
  }
  .wrap{max-width:1100px;margin:10px auto;}
  h1{font-size:20px;margin:6px 0 12px}
  p.lead{color:#555;margin:0 0 10px}
  .board{
    background:var(--card); border-radius:12px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,0.06);
  }

  /* ------ seat map layout (grid) ------ */
  .map{
    display:grid;
    grid-template-columns: repeat(12, 1fr);
    gap:10px;
    align-items:start;
    margin-top:12px;
  }

  .seat{
    height:56px; border-radius:8px; background:var(--seat); border:1px solid var(--seat-border);
    display:flex; align-items:center; justify-content:center; font-weight:700; color:#034;
    cursor:pointer; user-select:none;
  }
  .seat.small{ height:44px; font-size:13px }
  .seat.laptop{ background:var(--laptop); border-color:var(--laptop-border) }
  .seat.occupied{ background:var(--occupied); color:white; cursor:not-allowed; border-color:#000 }
  .seat.selected{ outline:3px solid #ffb74d }

  /* spacing boxes for layout */
  .sp{ background:transparent; border:none; pointer-events:none; }

  /* info area */
  .info{ display:flex; gap:12px; align-items:center; margin-top:12px; flex-wrap:wrap }
  .chip{ padding:6px 10px; background:#fff; border-radius:10px; box-shadow:0 5px 14px rgba(0,0,0,0.04) }
  .msg{ margin-left:8px; font-weight:600; color:#333 }

  /* quiz area */
  #quizArea{ display:none; margin-top:16px; }
  .qa-card{ background:#fff; padding:18px; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,0.06) }
  .choices{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap }
  .btn{
    padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:700;
    background:var(--accent); color:white;
  }
  .btn.gray{ background:#777 }
  .result{ margin-top:12px; font-weight:700; color:#333 }

  /* pass screen */
  #passScreen{ display:none; text-align:center; padding:30px; margin-top:12px }
  .pass-badge{ font-size:26px; font-weight:800; color:#2e7d32 }
</style>
</head>
<body>
  <div class="wrap">
    <h1>ä¸‰æ¨“é–±è¦½å¸­ â€” é¸ä½æ¨¡æ“¬</h1>
    <p class="lead">è«‹å¾ä¸‹æ–¹é¸æ“‡åº§ä½ï¼ˆç¶ è‰²å€å¡Šç‚ºç­†é›»å€ 105â€“136ï¼Œç°é»‘ç‚ºå·²æœ‰ä»–äººï¼‰ã€‚é¸å¥½åº§ä½å¾Œç³»çµ±æœƒè‡ªå‹•é€²å…¥å•ç­”é—œå¡ã€‚</p>

    <div class="board">
      <!-- seat map (12 åˆ— grid) -->
      <div id="map" class="map"></div>

      <div class="info">
        <div class="chip">ç­†é›»å€ï¼š105â€“136ï¼ˆæœ‰æ’åº§ï¼‰</div>
        <div class="chip">å·²æœ‰äººï¼ˆä¸å¯é¸ï¼‰ï¼š<span id="occupiedCount">0</span></div>
        <div class="msg" id="statusMsg">å°šæœªé¸ä½</div>
      </div>

      <!-- Quiz area -->
      <div id="quizArea">
        <div class="qa-card">
          <div id="qTitle" style="font-weight:800"></div>
          <div id="qBody" style="margin-top:8px;color:#444"></div>
          <div class="choices" id="choices"></div>
          <div class="result" id="qResult"></div>
        </div>
      </div>

      <!-- Pass area -->
      <div id="passScreen">
        <div class="pass-badge">ğŸ‰ ä½ å·²é€šéä¸‰æ¨“é–±è¦½å¸­è€ƒé©—</div>
        <p style="margin-top:10px;color:#555">æ„Ÿè¬ä½ å­¸ç¿’æ­£ç¢ºä½¿ç”¨é–±è¦½å¸­çš„è¦ç¯„ï¼</p>
        <button class="btn" onclick="location.reload()">è¿”å›ä¸¦é‡ç©</button>
      </div>
    </div>
  </div>

<script>
/* ---------- seat config ---------- */
/* We'll render seats roughly matching the red-box area + surrounding general seats.
   We'll define an ordered list of seat IDs and mark which are laptop seats (105-136).
   For layout aesthetics we use empty grid placeholders (sp).
*/

const laptopSeats = [];
for(let n=105;n<=136;n++) laptopSeats.push(String(n));

/* define all seat IDs we want to show (å·¦åŠå€é‡é» + å‘¨é‚Šä¸€èˆ¬åº§ä½)
   For simplicity we create some general seats before and after laptop block.
*/
const seatOrder = [
  // top row small general seats (arbitrary numbers left of laptop block)
  '093','094','095','096','097','098','099','100','101','102','103','104',

  // Laptop block top row 105-112
  '105','106','107','108','109','110','111','112',
  // row under: 113-120
  '113','114','115','116','117','118','119','120',
  // row under: 121-128
  '121','122','123','124','125','126','127','128',
  // row under: 129-136
  '129','130','131','132','133','134','135','136',

  // bottom row general seats (to fill grid)
  '137','138','139','140','141','142','143','144','145','146','147','148'
];

/* ---------- mark 70% occupied ---------- */
const totalSeats = seatOrder.length;
const occupyCount = Math.ceil(totalSeats * 0.7); // 70%
let occupiedSet = new Set();

// shuffle and pick occupied
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}
let tmp = [...seatOrder];
shuffle(tmp);
for(let i=0;i<occupyCount;i++){
  occupiedSet.add(tmp[i]);
}

/* ensure at least some laptop seats may be free for user to choose:
   if all laptop seats occupied, free one randomly
*/
const laptopOccupied = [...laptopSeats].every(id => occupiedSet.has(id));
if(laptopOccupied){
  const idx = Math.floor(Math.random() * laptopSeats.length);
  occupiedSet.delete(laptopSeats[idx]);
}

/* ---------- render map ---------- */
const map = document.getElementById('map');
map.innerHTML = '';
seatOrder.forEach((id, index) => {
  // create element
  const seat = document.createElement('div');
  seat.className = 'seat';
  seat.dataset.id = id;
  seat.innerText = id;

  // mark laptop class
  if(laptopSeats.includes(id)) seat.classList.add('laptop');

  // mark occupied
  if(occupiedSet.has(id)){
    seat.classList.add('occupied');
  } else {
    // attach click handler
    seat.addEventListener('click', ()=> selectSeat(id, seat));
  }

  map.appendChild(seat);
});

/* update occupied count */
document.getElementById('occupiedCount').innerText = occupiedSet.size;

/* ---------- selection and transition ---------- */
let selectedSeatId = null;
function selectSeat(id, el){
  if(el.classList.contains('occupied')) return;
  // remove previous selection class
  document.querySelectorAll('.seat.selected').forEach(s=>s.classList.remove('selected'));
  el.classList.add('selected');
  selectedSeatId = id;
  document.getElementById('statusMsg').innerText = `ä½ å·²é¸æ“‡åº§ä½ ${id}`;
  // delay 1 second then start quiz
  setTimeout(()=>{
    startQuiz();
  }, 1000); // 1s as you specified
}

/* ---------- QUIZ: questions (NPC style) ---------- */
/* We'll present a small sequence of NPC questions.
   Each question must be answered correctly to proceed.
*/

const questions = [
  {
    id:1,
    title: 'å• 1ï¼šåº§ä½å–æ¶ˆè¦å‰‡',
    body: 'å¦‚æœå€Ÿä½å¾Œé•·æ™‚é–“æ²’æœ‰ä½¿ç”¨ï¼Œå¤šä¹…æœƒè‡ªå‹•å–æ¶ˆï¼Ÿ',
    choices: [
      {txt:'30 åˆ†é˜', ok:false},
      {txt:'1 å°æ™‚', ok:false},
      {txt:'2 å°æ™‚', ok:true},
      {txt:'ä¸€å¤©', ok:false}
    ]
  },
  {
    id:2,
    title: 'å• 2ï¼šå“ªäº›åº§ä½æœ‰æ’åº§ï¼Ÿ',
    body: 'å“ªä¸€çµ„åº§ä½æ˜¯ã€Œæœ‰æ’åº§ã€çš„ç­†é›»å€ï¼Ÿ',
    choices: [
      {txt:'001â€“032', ok:false},
      {txt:'050â€“080', ok:false},
      {txt:'105â€“136', ok:true},
      {txt:'200â€“230', ok:false}
    ]
  },
  {
    id:3,
    title: 'å• 3ï¼šæ’åº§éœ€æ±‚åˆ†é…',
    body: `è‹¥æœ‰å­¸ç”Ÿéœ€è¦å……é›»ï¼ˆæ’åº§ï¼‰ï¼Œæ‡‰è©²å°‡ä»–å®‰æ’åˆ°å“ªé¡åº§ä½ï¼Ÿ`,
    choices:[
      {txt:'ä¸€èˆ¬åº§ä½', ok:false},
      {txt:'ç­†é›»å€ï¼ˆ105â€“136ï¼‰', ok:true},
      {txt:'ä»»ä½•ç©ºä½çš†å¯', ok:false},
      {txt:'èµ°é“æ—', ok:false}
    ]
  }
];

let qIndex = 0;

function startQuiz(){
  // hide map/info, show quizArea
  map.style.display = 'none';
  document.querySelector('.info').style.display = 'none';
  document.getElementById('quizArea').style.display = 'block';
  qIndex = 0;
  renderQuestion();
}

function renderQuestion(){
  const q = questions[qIndex];
  document.getElementById('qTitle').innerText = q.title;
  document.getElementById('qBody').innerText = q.body;
  const choices = document.getElementById('choices');
  choices.innerHTML = '';
  document.getElementById('qResult').innerText = '';
  q.choices.forEach(c=>{
    const b = document.createElement('button');
    b.className = 'btn';
    b.innerText = c.txt;
    b.onclick = ()=> {
      if(c.ok){
        document.getElementById('qResult').innerText = 'âœ… å›ç­”æ­£ç¢ºï¼';
        qIndex++;
        if(qIndex >= questions.length){
          // pass
          setTimeout(()=> showPass(), 700);
        } else {
          // next question after short delay
          setTimeout(()=> renderQuestion(), 700);
        }
      } else {
        document.getElementById('qResult').innerText = 'âŒ å›ç­”ä¸æ­£ç¢ºï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚';
      }
    };
    choices.appendChild(b);
  });
}

function showPass(){
  document.getElementById('quizArea').style.display = 'none';
  document.getElementById('passScreen').style.display = 'block';
}

/* ---------- end ---------- */
</script>
</body>
</html>
