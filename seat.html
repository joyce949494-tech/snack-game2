<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ä¸‰æ¨“é–±è¦½å¸­ï½œåˆ†é…åº§ä½éŠæˆ²</title>

<style>
body {
  font-family: "Microsoft JhengHei";
  background: #eef6ff;
  text-align: center;
  padding: 20px;
}

/* â€”â€”â€” å­¸ç”Ÿå¡ç‰‡ â€”â€”â€” */
.student {
  width: 120px;
  padding: 12px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 0 8px rgba(0,0,0,0.15);
  margin: 10px;
  cursor: grab;
}

.student:active {
  cursor: grabbing;
}

/* â€”â€”â€” åº§ä½åœ°åœ–å¸ƒå±€ â€”â€”â€” */
.map {
  width: 80%;
  max-width: 700px;
  margin: 25px auto;
  padding: 20px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

.grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 15px;
  margin-top: 20px;
}

/* â€”â€”â€” åº§ä½æ ¼å­ â€”â€”â€” */
.seat {
  width: 90px;
  height: 90px;
  border-radius: 12px;
  background: #dbe8ff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  transition: 0.2s;
}

.seat.wall {
  background: #b4d4ff;   /* é ç‰†æœ‰æ’åº§ */
}

.seat.laptop {
  background: #ffcfa9;   /* ç­†é›»å€ */
}

.seat.occupied {
  background: #888;
  color: white;
}

/* â€”â€”â€” æç¤ºæ–‡å­— â€”â€”â€” */
#msg {
  margin-top: 20px;
  font-size: 20px;
  font-weight: bold;
  color: #444;
}
</style>
</head>

<body>

<h2>ğŸ”Œ ä¸‰æ¨“é–±è¦½å¸­ï½œæ›¿å­¸ç”Ÿåˆ†é…åº§ä½</h2>
<p>æ‹–æ›³å­¸ç”Ÿ â†’ æ”¾åˆ°æœ€é©åˆä»–çš„åº§ä½ã€‚</p>

<!-- å­¸ç”Ÿåˆ—è¡¨ -->
<div id="students" style="display:flex; justify-content:center; flex-wrap:wrap;">
</div>

<!-- åº§ä½åœ°åœ– -->
<div class="map">
  <h3>ä¸‰æ¨“åº§ä½å¹³é¢åœ–</h3>
  <div class="grid" id="seatGrid"></div>
</div>

<p id="msg"></p>

<script>
// å­¸ç”Ÿéœ€æ±‚è³‡æ–™
const students = [
  { id: 1, name: "å°ç¾", need: "normal" },
  { id: 2, name: "å°å‚‘", need: "power" },
  { id: 3, name: "é˜¿è¯", need: "laptop" }
];

// åº§ä½è³‡æ–™
const seats = [
  { id: "A1", type: "wall" },
  { id: "A2", type: "wall" },
  { id: "B1", type: "normal" },
  { id: "B2", type: "normal" },
  { id: "C1", type: "laptop" },
  { id: "C2", type: "laptop" },
  { id: "D1", type: "normal" },
  { id: "D2", type: "normal" }
];

let remaining = [...students];

/* â€”â€”â€” ç”Ÿæˆå­¸ç”Ÿå¡ç‰‡ â€”â€”â€” */
function renderStudents() {
  const box = document.getElementById("students");
  box.innerHTML = "";
  remaining.forEach(s => {
    let div = document.createElement("div");
    div.className = "student";
    div.draggable = true;
    div.id = "stu-" + s.id;
    div.innerHTML = `<b>${s.name}</b><br>éœ€æ±‚ï¼š${translateNeed(s.need)}`;
    div.ondragstart = e => e.dataTransfer.setData("student", s.id);
    box.appendChild(div);
  });
}

/* â€”â€”â€” ç”Ÿæˆåº§ä½ â€”â€”â€” */
function renderSeats() {
  const grid = document.getElementById("seatGrid");
  seats.forEach(seat => {
    let div = document.createElement("div");
    div.className = "seat " + seat.type;
    div.id = "seat-" + seat.id;
    div.innerText = seat.id;

    div.ondragover = e => e.preventDefault();
    div.ondrop = e => handleDrop(e, seat);

    grid.appendChild(div);
  });
}

/* â€”â€”â€” è™•ç†æ‹–æ›³ â€”â€”â€” */
function handleDrop(e, seat) {
  const sid = e.dataTransfer.getData("student");
  const student = remaining.find(s => s.id == sid);

  if (!student) return;

  let seatDiv = document.getElementById("seat-" + seat.id);

  // åº§ä½å·²æœ‰äºº
  if (seatDiv.classList.contains("occupied")) {
    showMsg("âŒ é€™å€‹åº§ä½å·²ç¶“æœ‰äººå›‰ï¼");
    return;
  }

  // æ’åº§éœ€æ±‚ â†’ å¿…é ˆ wall æˆ– laptop
  if (student.need === "power" && seat.type !== "wall" && seat.type !== "laptop") {
    showMsg("âš¡ é€™ä½å­¸ç”Ÿéœ€è¦æ’åº§ï¼Œåªèƒ½åé ç‰†æˆ–ç­†é›»å€ï¼");
    return;
  }

  // ç­†é›»å€éœ€æ±‚
  if (student.need === "laptop" && seat.type !== "laptop") {
    showMsg("ğŸ’» é€™ä½å­¸ç”Ÿåªèƒ½åç­†é›»å€ï¼");
    return;
  }

  // æ­£ç¢ºæ”¾ç½®
  seatDiv.classList.add("occupied");
  seatDiv.innerText = `${seat.id}\nï¼ˆ${student.name}ï¼‰`;

  remaining = remaining.filter(s => s.id != sid);
  document.getElementById("stu-" + sid).remove();

  if (remaining.length === 0) {
    showMsg("ğŸ‰ å…¨éƒ¨å­¸ç”Ÿéƒ½å®‰æ’å®Œæˆï¼ä½ é€šéä¸‰æ¨“é–±è¦½å¸­è€ƒé©—ï¼");
  } else {
    showMsg("âœ” å®‰æ’æˆåŠŸï¼ç¹¼çºŒå”åŠ©å…¶ä»–å­¸ç”Ÿï½");
  }
}

/* â€”â€”â€” é¡¯ç¤ºæç¤º â€”â€”â€” */
function showMsg(txt) {
  document.getElementById("msg").innerText = txt;
}

/* â€”â€”â€” ç¿»è­¯éœ€æ±‚åç¨± â€”â€”â€” */
function translateNeed(n) {
  return {
    power: "æ’åº§",
    laptop: "ç­†é›»å€",
    normal: "ä¸€èˆ¬åº§ä½"
  }[n];
}

/* â€”â€”â€” åˆå§‹åŒ– â€”â€”â€” */
renderStudents();
renderSeats();
</script>

</body>
</html>
