<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ä¸‰æ¨“é–±è¦½å¸­ï½œåˆ†çµ„é¸ä½éŠæˆ²</title>

<style>
body {
  font-family: "Microsoft JhengHei";
  background: #eef6ff;
  text-align: center;
  padding: 20px;
}

/* å­¸ç”Ÿå¡ç‰‡ */
.group {
  width: 140px;
  padding: 15px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 0 8px rgba(0,0,0,0.15);
  margin: 10px;
  cursor: grab;
}
.group:active { cursor: grabbing; }

/* åº§ä½åœ°åœ–å¤–æ¡† */
.map {
  width: 80%;
  max-width: 850px;
  margin: 25px auto;
  padding: 20px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

.grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 12px;
  margin-top: 20px;
}

/* åº§ä½æ¨£å¼ */
.seat {
  width: 95px;
  height: 95px;
  border-radius: 12px;
  background: #dbe8ff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  transition: 0.2s;
}

.seat.available { background: #2e3a4d; color: white; }
.seat.temp { background: #ffcc33; }
.seat.disabled { background: #e5e5e5; color: #aaa; }
.seat.chosen { background: white; color: #444; border: 2px solid #2e3a4d; }

.seat.filled {
  background: #4a7fe8;
  color: white;
}

/* è¨Šæ¯ */
#msg {
  margin-top: 25px;
  font-size: 22px;
  font-weight: bold;
  color: #444;
}
</style>
</head>

<body>

<h2>ğŸ”· ä¸‰æ¨“é–±è¦½å¸­åˆ†çµ„é¸ä½</h2>
<p>è«‹å°‡æ¯çµ„æ‹–ç§»åˆ°æ­£ç¢ºçš„åº§ä½å€ã€‚</p>

<!-- å­¸ç”Ÿåˆ†çµ„ -->
<div id="groups" style="display:flex; justify-content:center; flex-wrap:wrap;"></div>

<!-- åº§ä½åœ°åœ– -->
<div class="map">
  <h3>å¯é¸åº§ä½å€</h3>
  <div class="grid" id="seatGrid"></div>
</div>

<p id="msg"></p>

<script>
// ---------------------------------------
// åˆ†çµ„è¨­å®š
// ---------------------------------------
const groups = [
  { id: "A", size: 3, seats: [] },
  { id: "B", size: 2, seats: [] },
  { id: "C", size: 2, seats: [] },
  { id: "D", size: 1, seats: [] }
];

// è§£ç­”ï¼ˆå”¯ä¸€æ­£è§£ï¼‰
const correct = {
  A: ["121", "122", "123"],
  B: ["113", "114"],
  C: ["129", "130"],
  D: ["093"] // D çµ„å¯ä»¥å½ˆæ€§ï¼Œä½†é€™è£¡å…ˆå›ºå®šç‚º 093
};

// ---------------------------------------
// åº§ä½è³‡æ–™
// ---------------------------------------
const seats = [
  "093","098","105","125","129","130",
  "113","114","121","122","123"
];

// ---------------------------------------
// ç”¢ç”Ÿåˆ†çµ„å¡ç‰‡
// ---------------------------------------
function renderGroups(){
  const box = document.getElementById("groups");
  box.innerHTML = "";
  groups.forEach(g=>{
    const div = document.createElement("div");
    div.className = "group";
    div.id = "group-" + g.id;
    div.draggable = true;
    div.ondragstart = e => e.dataTransfer.setData("group", g.id);
    div.innerHTML = `<b>${g.id} çµ„</b><br>(${g.size} äºº)`;
    box.appendChild(div);
  });
}

// ---------------------------------------
// ç”Ÿæˆå¯é¸åº§ä½
// ---------------------------------------
function renderSeats(){
  const grid = document.getElementById("seatGrid");
  seats.forEach(id=>{
    const div = document.createElement("div");
    div.className = "seat available";
    div.id = "seat-" + id;
    div.innerText = id;

    div.ondragover = e => e.preventDefault();
    div.ondrop = e => handleDrop(e, id);

    grid.appendChild(div);
  });
}

// ---------------------------------------
// è™•ç†æ”¾ç½®
// ---------------------------------------
function handleDrop(e, seatID){
  const gid = e.dataTransfer.getData("group");
  const group = groups.find(g => g.id === gid);

  if(!group || group.seats.length >= group.size){
    showMsg("âŒ é€™çµ„çš„äººæ•¸å·²ç¶“æ”¾æ»¿äº†ï¼");
    return;
  }

  const seatDiv = document.getElementById("seat-" + seatID);

  if(seatDiv.classList.contains("filled")){
    showMsg("âŒ é€™å€‹åº§ä½å·²è¢«ä½¿ç”¨ï¼");
    return;
  }

  // æ”¾é€²å»
  seatDiv.classList.add("filled");
  seatDiv.innerHTML = `${seatID}\n(${gid})`;
  group.seats.push(seatID);

  checkComplete();
}

// ---------------------------------------
// æª¢æŸ¥æ˜¯å¦å…¨éƒ¨å®Œæˆ
// ---------------------------------------
function checkComplete(){
  let allDone = groups.every(g => g.seats.length === g.size);
  if(!allDone) return;

  // æª¢æŸ¥æ˜¯å¦æ­£ç¢º
  let ok = true;
  groups.forEach(g=>{
    let required = correct[g.id];
    let placed = g.seats.sort();
    if(required.sort().join("") !== placed.join("")){
      ok = false;
    }
  });

  if(ok){
    showMsg("ğŸ‰ é¸ä½æˆåŠŸï¼å³å°‡é€²å…¥ä¸‹ä¸€éšæ®µâ€¦");

    // å»¶é² 2 ç§’è·³è½‰
    setTimeout(()=>{
      window.location.href = "quiz.html"; // â† ä¿®æ”¹æˆä½ çš„é¡Œç›®é é¢
    }, 2000);

  }else{
    showMsg("âŒ æœ‰çµ„æ²’æœ‰æ”¾åœ¨æ­£ç¢ºçš„ä½ç½®å–”ï¼");
  }
}

// ---------------------------------------
function showMsg(t){
  document.getElementById("msg").innerText = t;
}

// åˆå§‹åŒ–
renderGroups();
renderSeats();
</script>

</body>
</html>
