<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ä¸‰æ¨“é–±è¦½å¸­ï½œåˆ†é…åº§ä½éŠæˆ²</title>

<style>
body {
  font-family: "Microsoft JhengHei";
  background: #eef6ff;
  text-align: center;
  padding: 20px;
}

/* â€”â€”â€” å­¸ç”Ÿå¡ç‰‡ â€”â€”â€” */
.student {
  width: 120px;
  padding: 12px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 0 8px rgba(0,0,0,0.15);
  margin: 10px;
  cursor: grab;
}

.map, #qaSection {
  width: 80%;
  max-width: 700px;
  margin: 25px auto;
  padding: 20px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

/* â€”â€”â€” åº§ä½åœ°åœ–å¸ƒå±€ â€”â€”â€” */
.grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 15px;
  margin-top: 20px;
}

/* â€”â€”â€” åº§ä½æ ¼å­ â€”â€”â€” */
.seat {
  width: 90px;
  height: 90px;
  border-radius: 12px;
  background: #dbe8ff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  text-align: center;
  white-space: pre-line;
}

.seat.wall { background: #b4d4ff; }
.seat.laptop { background: #ffcfa9; }
.seat.occupied { background: #888; color: white; }

/* â€”â€”â€” Q&A æŒ‰éˆ• â€”â€”â€” */
.qaBtn {
  padding: 12px 20px;
  margin: 10px;
  background: #4e8aff;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  cursor: pointer;
}

.qaBtn:hover {
  background: #336dff;
}

#msg {
  margin-top: 20px;
  font-size: 20px;
  font-weight: bold;
  color: #444;
}
</style>
</head>

<body>

<h2>ğŸ”Œ ä¸‰æ¨“é–±è¦½å¸­ï½œæ›¿å­¸ç”Ÿåˆ†é…åº§ä½</h2>
<p id="topText">æ‹–æ›³å­¸ç”Ÿ â†’ æ”¾åˆ°æœ€é©åˆä»–çš„åº§ä½ã€‚</p>

<!-- å­¸ç”Ÿåˆ—è¡¨ -->
<div id="students" style="display:flex; justify-content:center; flex-wrap:wrap;"></div>

<!-- åº§ä½åœ°åœ– -->
<div class="map" id="seatMap">
  <h3>ä¸‰æ¨“åº§ä½å¹³é¢åœ–</h3>
  <div class="grid" id="seatGrid"></div>
</div>

<!-- NPC å•ç­” å€å¡Š -->
<div id="qaSection" style="display:none;">
  <h3>ğŸ“š NPC ä½¿ç”¨å•é¡Œ</h3>
  <p id="qaQuestion" style="font-size:18px; font-weight:bold;"></p>

  <div id="qaButtons"></div>
  <p id="qaMsg" style="color:#444; font-size:18px; margin-top:10px;"></p>
</div>

<p id="msg"></p>

<script>
/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    åº§ä½éŠæˆ²è³‡æ–™
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
const students = [
  { id: 1, name: "å°ç¾", need: "normal" },
  { id: 2, name: "å°å‚‘", need: "power" },
  { id: 3, name: "é˜¿è¯", need: "laptop" }
];

const seats = [
  { id: "A1", type: "wall" },
  { id: "A2", type: "wall" },
  { id: "B1", type: "normal" },
  { id: "B2", type: "normal" },
  { id: "C1", type: "laptop" },
  { id: "C2", type: "laptop" },
  { id: "D1", type: "normal" },
  { id: "D2", type: "normal" }
];

let remaining = [...students];

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    NPC å•ç­”è³‡æ–™
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
let qaIndex = 0;

const qaList = [
  {
    q: "æˆ‘å€Ÿä½å¾Œéƒ½æ²’å›ä¾†ï¼Œå¤šä¹…æœƒè¢«å–æ¶ˆï¼Ÿ",
    options: ["30 åˆ†é˜", "1 å°æ™‚", "2 å°æ™‚ï¼ˆé›¢é¤¨è¶…éæœƒå–æ¶ˆï¼‰"],
    answer: 2
  },
  {
    q: "å“ªäº›åº§ä½æœ‰æ’åº§ï¼Ÿ",
    options: ["å…¨éƒ¨åº§ä½éƒ½æœ‰", "é ç‰†åº§ä½èˆ‡ç­†é›»å€", "åªæœ‰ç­†é›»å€"],
    answer: 1
  }
];

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    DOM å»ºç«‹
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function renderStudents() {
  const box = document.getElementById("students");
  box.innerHTML = "";
  remaining.forEach(s => {
    let div = document.createElement("div");
    div.className = "student";
    div.draggable = true;
    div.id = "stu-" + s.id;
    div.innerHTML = `<b>${s.name}</b><br>éœ€æ±‚ï¼š${translateNeed(s.need)}`;
    div.ondragstart = e => e.dataTransfer.setData("student", s.id);
    box.appendChild(div);
  });
}

function renderSeats() {
  const grid = document.getElementById("seatGrid");
  seats.forEach(seat => {
    let div = document.createElement("div");
    div.className = "seat " + seat.type;
    div.id = "seat-" + seat.id;
    div.innerText = seat.id;

    div.ondragover = e => e.preventDefault();
    div.ondrop = e => handleDrop(e, seat);

    grid.appendChild(div);
  });
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    è™•ç†æ‹–æ›³
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function handleDrop(e, seat) {
  const sid = e.dataTransfer.getData("student");
  const student = remaining.find(s => s.id == sid);
  if (!student) return;

  let seatDiv = document.getElementById("seat-" + seat.id);

  if (seatDiv.classList.contains("occupied")) {
    showMsg("âŒ é€™å€‹åº§ä½å·²ç¶“æœ‰äººå›‰ï¼");
    return;
  }

  if (student.need === "power" && seat.type !== "wall" && seat.type !== "laptop") {
    showMsg("âš¡ é€™ä½å­¸ç”Ÿéœ€è¦æ’åº§ï¼Œåªèƒ½åé ç‰†æˆ–ç­†é›»å€ï¼");
    return;
  }

  if (student.need === "laptop" && seat.type !== "laptop") {
    showMsg("ğŸ’» é€™ä½å­¸ç”Ÿåªèƒ½åç­†é›»å€ï¼");
    return;
  }

  seatDiv.classList.add("occupied");
  seatDiv.innerText = `${seat.id}\nï¼ˆ${student.name}ï¼‰`;

  remaining = remaining.filter(s => s.id != sid);
  document.getElementById("stu-" + sid).remove();

  if (remaining.length === 0) {
    showMsg("");
    startQA();  // â† å•ç­”é–‹å§‹ï¼
  } else {
    showMsg("âœ” å®‰æ’æˆåŠŸï¼ç¹¼çºŒå”åŠ©å…¶ä»–å­¸ç”Ÿï½");
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    NPC å•ç­”æ¨¡å¼
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function startQA() {
  document.getElementById("students").style.display = "none";
  document.getElementById("seatMap").style.display = "none";
  document.getElementById("topText").style.display = "none";

  document.getElementById("qaSection").style.display = "block";
  loadQuestion();
}

function loadQuestion() {
  if (qaIndex >= qaList.length) {
    document.getElementById("qaSection").innerHTML =
      `<h2>ğŸ‰ ä½ å·²é€šéä¸‰æ¨“é–±è¦½å¸­è€ƒé©—ï¼</h2>`;
    return;
  }

  const q = qaList[qaIndex];
  document.getElementById("qaQuestion").innerText = q.q;

  const btnBox = document.getElementById("qaButtons");
  btnBox.innerHTML = "";

  q.options.forEach((opt, i) => {
    let btn = document.createElement("button");
    btn.className = "qaBtn";
    btn.innerText = opt;
    btn.onclick = () => checkAnswer(i);
    btnBox.appendChild(btn);
  });
}

function checkAnswer(choice) {
  const q = qaList[qaIndex];
  const msg = document.getElementById("qaMsg");

  if (choice === q.answer) {
    msg.innerText = "âœ” ç­”å°äº†ï¼";
    qaIndex++;
    setTimeout(() => {
      msg.innerText = "";
      loadQuestion();
    }, 700);
  } else {
    msg.innerText = "âŒ å†æƒ³æƒ³çœ‹ï½";
  }
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    å·¥å…·
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
function showMsg(t) { document.getElementById("msg").innerText = t; }

function translateNeed(n) {
  return { power: "æ’åº§", laptop: "ç­†é›»å€", normal: "ä¸€èˆ¬åº§ä½" }[n];
}

/* â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    åˆå§‹åŒ–
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” */
renderStudents();
renderSeats();
</script>

</body>
</html>
