<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ä¸‰æ¨“é–±è¦½å¸­ï½œåˆ†é…åº§ä½éŠæˆ²</title>

<style>

/* === DEBUGï¼šé¡¯ç¤ºåº§ä½ç†±å€ä½ç½® === */
.seat-zone {
  position: absolute;
  border: 2px solid red !important;   /* é¡¯ç¤ºç´…æ¡† */
  background: rgba(255,0,0,0.2) !important; /* åŠé€æ˜ç´…è‰² */
  z-index: 50 !important;
}

  
body {
  font-family: "Microsoft JhengHei", sans-serif;
  background: #eef6ff;
  text-align: center;
  padding: 20px;
}

h2 {
  margin-bottom: 10px;
}

/* å­¸ç”Ÿå¡ç‰‡ */
.student {
  width: 130px;
  padding: 12px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 0 8px rgba(0,0,0,0.15);
  margin: 10px;
  cursor: grab;
}

.student:active {
  cursor: grabbing;
}

#students {
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
}

/* åº§ä½åœ– */
.map-container {
  position: relative;
  width: 900px;
  margin: 20px auto;
}

.map-container img {
  width: 100%;
  border-radius: 12px;
  pointer-events: none; /* é¿å…é˜»æ“‹æ‹–æ›³ */
}

/* åº§ä½å€åŸŸ */
.seat-zone {
  position: absolute;
  width: 42px;
  height: 42px;
  border-radius: 6px;
  cursor: pointer;
  z-index: 10; /* ä¿è­‰åœ¨åœ–ç‰‡ä¸Šå±¤ */
}

.seat-zone.occupied {
  background: white !important;
  border: 2px solid #ccc;
}

#msg {
  margin-top: 20px;
  font-size: 20px;
  font-weight: bold;
  color: #444;
}
</style>
</head>

<body>

<h2>ğŸ”¹ ä¸‰æ¨“é–±è¦½å¸­ï½œæ›¿å­¸ç”Ÿåˆ†é…åº§ä½</h2>
<p>æŠŠå­¸ç”Ÿçµ„åˆ¥æ‹–æ›³åˆ°å…è¨±çš„åº§ä½ä¸­ï¼ˆåŒçµ„åªéœ€æ‹–ä¸€æ¬¡ï¼‰</p>

<div id="students"></div>

<!-- â˜…â˜…â˜…â˜…â˜… åº§ä½åœ–å€åŸŸ â˜…â˜…â˜…â˜…â˜… -->
<div class="map-container">
  <img src="https://i.imgur.com/B9oHV5K.jpeg">

  <!-- çµ„1å°ˆç”¨ï¼š93 / 98 / 105 / 125 -->
  <div class="seat-zone" data-seat="93"  data-allow="1" style="top:120px; left:40px;"></div>
  <div class="seat-zone" data-seat="98"  data-allow="1" style="top:260px; left:40px;"></div>
  <div class="seat-zone" data-seat="105" data-allow="1" style="top:120px; left:740px;"></div>
  <div class="seat-zone" data-seat="125" data-allow="1" style="top:260px; left:740px;"></div>

  <!-- çµ„2ï¼‹çµ„3å…±ç”¨ï¼š113 / 114 / 121 / 122 / 123 / 129 / 130 -->
  <div class="seat-zone" data-seat="113" data-allow="23" style="top:330px; left:380px;"></div>
  <div class="seat-zone" data-seat="114" data-allow="23" style="top:330px; left:430px;"></div>

  <div class="seat-zone" data-seat="121" data-allow="23" style="top:390px; left:380px;"></div>
  <div class="seat-zone" data-seat="122" data-allow="23" style="top:390px; left:430px;"></div>
  <div class="seat-zone" data-seat="123" data-allow="23" style="top:390px; left:480px;"></div>

  <div class="seat-zone" data-seat="129" data-allow="23" style="top:450px; left:380px;"></div>
  <div class="seat-zone" data-seat="130" data-allow="23" style="top:450px; left:430px;"></div>
</div>

<p id="msg"></p>

<!-- â˜…â˜…â˜…â˜…â˜… JavaScript â˜…â˜…â˜…â˜…â˜… -->
<script>
// å­¸ç”Ÿåˆ†çµ„
const students = [
  {id:1, name:"å°ç¾", group:1},
  {id:2, name:"å°å‚‘", group:2},
  {id:3, name:"é˜¿è¯", group:3},
  {id:4, name:"å°æ—", group:3},
  {id:5, name:"å°ç‹", group:2}
];

let remainingGroups = [...new Set(students.map(s=>s.group))];
const msg = document.getElementById("msg");

// ç”Ÿæˆå­¸ç”Ÿå¡
function renderStudents() {
  const box = document.getElementById("students");
  box.innerHTML = "";
  remainingGroups.forEach(g=>{
    const groupStudents = students.filter(s=>s.group===g);
    const div = document.createElement("div");
    div.className = "student";
    div.draggable = true;
    div.id = "group-"+g;
    div.innerHTML = `<b>çµ„${g}</b><br>` + groupStudents.map(s=>s.name).join(", ");
    div.ondragstart = e => e.dataTransfer.setData("group", g);
    box.appendChild(div);
  });
}
renderStudents();

// åº§ä½æ‹–æ›³è™•ç†
document.querySelectorAll(".seat-zone").forEach(zone=>{
  zone.addEventListener("dragover", e => e.preventDefault());

  zone.addEventListener("drop", e=>{
    e.preventDefault();
    const groupId = e.dataTransfer.getData("group");
    const card = document.getElementById("group-"+groupId);
    if(!card) return;

    // åº§ä½æ˜¯å¦è¢«ä½”ç”¨
    if(zone.classList.contains("occupied")) {
      showMsg("âŒ é€™å€‹åº§ä½å·²ç¶“æœ‰äººäº†ï¼");
      return;
    }

    // åº§ä½å…è¨±å“ªäº›çµ„
    const allowed = zone.dataset.allow;

    if(!allowed.includes(groupId)) {
      showMsg("âŒ é€™çµ„ä¸èƒ½åé€™å€‹åº§ä½ï¼");
      return;
    }

    // æˆåŠŸæ”¾ç½®
    zone.classList.add("occupied");
    card.remove();

    // ç§»é™¤è©²çµ„
    remainingGroups = remainingGroups.filter(x => x != groupId);
    showMsg("âœ” çµ„ " + groupId + " å®‰æ’æˆåŠŸï¼");

    // å…¨éƒ¨åˆ†é…å®Œæˆ
    if(remainingGroups.length === 0){
      showMsg("ğŸ‰ å…¨éƒ¨å­¸ç”Ÿåº§ä½å®‰æ’å®Œæˆï¼");
      setTimeout(()=>{
        window.location.href = "npc_question_page.html";
      }, 1800);
    }
  });
});

// é¡¯ç¤ºè¨Šæ¯
function showMsg(t){
  msg.innerText = t;
}
</script>

</body>
</html>
