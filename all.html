<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>六大遊戲挑戰</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        h1 {
            margin-top: 30px;
        }

        #medalBox {
            position: fixed;
            top: 10px;
            right: 10px;
            font-size:20px;
            background: #ffd700;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
        }

        .gameArea {
            display: flex;
            justify-content: center;
            margin-top: 50px;
            flex-wrap: wrap;
            gap: 20px;
        }

        button {
            width: 220px;
            height: 80px;
            font-size: 20px;
            cursor: pointer;
            border-radius: 20px;
            border: none;
            background: #0099ff;
            color: white;
        }

        button:disabled {
            background: gray;
            cursor:not-allowed;
        }
    </style>
</head>

<body>
    <div id="medalBox">獎章：<span id="medalCount">0</span>/6</div>

    <h1>遊戲挑戰主頁</h1>
    <p>完成六個遊戲就獲得六枚獎章！</p>

    <div class="gameArea">
        <button id="game1">遊戲 1</button>
        <button id="game2">遊戲 2</button>
        <button id="game3">遊戲 3</button>
        <button id="game4">遊戲 4</button>
        <button id="game5">遊戲 5</button>
        <button id="game6">遊戲 6</button>
    </div>

<script>
let medalCount = 0;
document.getElementById("medalCount").innerText = medalCount;

// 遊戲網址庫
const links = [
"https://joyce949494-tech.github.io/snack-game2/computer.html",
"https://joyce949494-tech.github.io/snack-game2/borrow.html",
"https://joyce949494-tech.github.io/snack-game2/findbook.html",
"https://joyce949494-tech.github.io/snack-game2/index.html",
"https://joyce949494-tech.github.io/snack-game2/student.html",
"https://joyce949494-tech.github.io/snack-game2/seat.html"
];

// 讀取完成紀錄
if (localStorage.getItem("medalList") === null) {
    localStorage.setItem("medalList", JSON.stringify([false,false,false,false,false,false]));
}

function goGame(index) {

    let list = JSON.parse(localStorage.getItem("medalList"));

    // 防止重複遊玩
    if (list[index]) {
        alert("此遊戲已完成！");
        return;
    }

    // 新視窗打開遊戲
    let win = window.open(links[index],"_self");

    // 回到主畫面時執行 → 承認完成 + 獎章
    window.addEventListener("focus",() => {

        let listBack = JSON.parse(localStorage.getItem("medalList"));

        // 如果還沒拿過獎章 → 拿
        if (!listBack[index]) {

            listBack[index] = true;
            localStorage.setItem("medalList", JSON.stringify(listBack));

            medalCount++;
            document.getElementById("medalCount").innerText = medalCount;

            document.getElementById("game"+(index+1)).disabled = true;
        }

    },{once:true});

}


// 初始化按鈕
let medalList = JSON.parse(localStorage.getItem("medalList"));
medalCount = medalList.filter(v => v === true).length;
document.getElementById("medalCount").innerText = medalCount;

// 亮起按鈕
for(let i=0;i<6;i++){
    let btn = document.getElementById("game"+(i+1));
    btn.onclick = () => goGame(i);

    // 已完成 → 禁止
    if(medalList[i]){
        btn.disabled = true;
    }
}
</script>

</body>
</html>
